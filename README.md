SnowflakeのAGGREGATION POLICYを使って、利用者のロールによって集計値のみ/明細行レベルを見れるかどうかの制御をするデモです。

## 準備するもの
* Snowflakeアカウント（Enterprise Edition以上必須、トライアルでOK）
* SYSADMINおよびUSERADMIN権限
* 仮想ウェアハウスを事前に一つ作成しておくこと（スクリプト内ではmy_whを使用）

## 対象の問題
https://frostyfriday.org/blog/2024/03/22/week-86-difficult/

### 要件：
* SQLクエリを使用して、指定されたテーブルまたはビューからデータを集計します
* 集約ポリシーによって許可されている集約関数に準拠します。
* クエリによって形成された各グループに、集約ポリシーに従って少なくとも指定された最小数のレコードが含まれていることを確認します。

### 手順：
  1. 以下のコードを使用して、「Sales_Records」というサンプルテーブルを作成します
  2. 最小グループ サイズ (X) を持つ集約ポリシーを定義します。
  3. 集約ポリシーの要件に従って、選択したデータセットからデータを集約する SQL クエリを作成します。
  4. クエリをテストして、ポリシーに準拠していることを確認します。

### 参考マニュアル
https://docs.snowflake.com/ja/user-guide/aggregation-policies
